snapshotmanag restoresnapshot updat tabl region count quota correctli encount snapshotmanag restoresnapshot tabl region quota check updat tabl exist check updat region quota tabl namespac checkandupdatenamespaceregionquota manifest tablenam restoresnapshot snapshot snapshottabledesc catch ioexcept master getmasterquotamanag removetablefromnamespacequota tablenam log error occur restor snapshot snapshot getnam tabl tablenam getnameasstr throw amp apo checkandupdatenamespaceregionquota amp apo fail region snapshot make region count quota exceed tabl remov amp apo catch amp apo block make tabl count region count decreas tabl creation region split succe quota exceed