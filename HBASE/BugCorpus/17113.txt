find middl kei hfilev2 wrong indexoutofboundsexcept split region middl rowkei biggest store file code hfileblockindex midkei find approxim middl kei cach pread assum compact hfileblock midleafblock cachingblockread readblock midleafblockoffset midleafblockondisks true true fals true blocktyp leaf index null bytebuff midleafblock getbufferwithouthead int numdatablock getint int keyreloffset getint byte sizeof int midkeyentri 1 int keylen getint byte sizeof int midkeyentri 2 keyreloffset secondari index entri overhead int keyoffset byte sizeof int numdatablock 2 keyreloffset secondari index entri overhead targetmidkei bytebufferutil tobyt keyoffset keylen entri root block index object 1 offset block referenc entri file long 2 ondisk size referenc block int 3 rowkei cacul keylen entri forget 12 byte overhead 1 2 secondari index entri overhead code keylen 12 byte bigger real rowkei length time read rowkei form entri read 12 byte entri throw middl kei entri root block index indexoutofboundsexcept hbase 16097 suffer 2016 11 16 05 27 31 991 error memstoreflush 1 regionserv memstoreflush cach flusher fail entri flush region hitsdb x14 x03 x83 x1ax x1a x9a x00 x00 x07 x00 x00 x07 x00 x00 x09 x00 x00 x09 x00 x01 x9f x00f xe3 x00 x00 x0a x00 x01 x00 x00 x08 x00 x5c x09 x00 x03 x11 x00 xef x99 1478311873096 79d3f7f285396b6896f3229e2bcac7af java lang indexoutofboundsexcept java nio buffer checkindex buffer java 532 java nio heapbytebuff heapbytebuff java 139 org apach hadoop hbase util bytebufferutil tobyt bytebufferutil java 490 org apach hadoop hbase io hfile hfileblockindex blockindexread midkei hfileblockindex java 349 org apach hadoop hbase io hfile hfilereaderv2 midkei hfilereaderv2 java 529 org apach hadoop hbase regionserv storefil reader midkei storefil java 1527 org apach hadoop hbase regionserv storefil getfilesplitpoint storefil java 684 org apach hadoop hbase regionserv defaultstorefilemanag getsplitpoint defaultstorefilemanag java 126 org apach hadoop hbase regionserv hstore getsplitpoint hstore java 1976 org apach hadoop hbase regionserv regionsplitpolici getsplitpoint regionsplitpolici java 82 org apach hadoop hbase regionserv hregion checksplit hregion java 7614 org apach hadoop hbase regionserv memstoreflush flushregion memstoreflush java 521 org apach hadoop hbase regionserv memstoreflush flushregion memstoreflush java 471 org apach hadoop hbase regionserv memstoreflush access 800 memstoreflush java 75 org apach hadoop hbase regionserv memstoreflush flushhandl run memstoreflush java 259 java lang thread run thread java 756 bug exsit hfilev2 invent found bug find middlekei compar rowkei left side ad 12 byte side total care won amp apo throw indexoutofboundsexcept hbase 12297 arrai copyofrang check limit ensu length won amp apo run past end arrai bytebufferutil tobyt indexoutofboundsexcept thrown product environ bug region amp apo split grow bigger bigger