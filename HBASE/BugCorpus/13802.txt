procedur v2 master fail due rollback creat namespac tabl procedur v2 hbase 13203 implement rollback createtableprocedur call quota manag remov tabl namespac quota protect static void deletetablest final masterprocedureenv env final tablenam tablenam proceduresyncwait getmasterquotamanag env removetablefromnamespacequota tablenam lead amp apo deadlock amp apo situat master start 1 creat namespac tabl procedur fail middl master crash failov master start rollback step rollback call quotamanag remov tabl namespacequota quotamanag start rollback wait 2 quotamanag start master namespac manag start 3 namespac manag wait tabl lock releas rollback creat namespac tabl procedur creat namespac tabl part namespac manag initi hmaster finishactivemasteriniti statu setstatu start namespac manag initnamespac statu setstatu start quota manag initquotamanag 4 1 wait 2 wait 3 wait 1 make progress amp master complet initi fail 2015 05 28 10 01 26 890 info ip 111 22 33 444 16000 activemastermanag master tablenamespacemanag namespac tabl found creat 2015 05 28 10 06 22 016 warn procedureexecutorthread 0 procedur createtableprocedur fail rollback attempt step creat tabl pre oper tabl hbase namespac org apach hadoop hbase timeoutioexcept time wait quota manag org apach hadoop hbase master procedur proceduresyncwait waitfor proceduresyncwait java 122 org apach hadoop hbase master procedur proceduresyncwait waitfor proceduresyncwait java 102 org apach hadoop hbase master procedur proceduresyncwait getmasterquotamanag proceduresyncwait java 184 org apach hadoop hbase master procedur deletetableprocedur deletetablest deletetableprocedur java 408 org apach hadoop hbase master procedur createtableprocedur rollbackst createtableprocedur java 169 org apach hadoop hbase master procedur createtableprocedur rollbackst createtableprocedur java 58 org apach hadoop hbase procedure2 statemachineprocedur rollback statemachineprocedur java 121 org apach hadoop hbase procedure2 procedur dorollback procedur java 414 org apach hadoop hbase procedure2 procedureexecutor executerollback procedureexecutor java 808 org apach hadoop hbase procedure2 procedureexecutor executerollback procedureexecutor java 773 org apach hadoop hbase procedure2 procedureexecutor execloop procedureexecutor java 653 org apach hadoop hbase procedure2 procedureexecutor execloop procedureexecutor java 626 org apach hadoop hbase procedure2 procedureexecutor access 200 procedureexecutor java 70 org apach hadoop hbase procedure2 procedureexecutor 1 run procedureexecutor java 413 2015 05 28 10 06 22 169 warn procedureexecutorthread 1 procedur createtableprocedur tabl hbase namespac exist meta znode run hbck fix inconsist 2015 05 28 10 06 27 292 fatal ip 111 22 33 444 16000 activemastermanag master hmaster fail activ master java io ioexcept timedout 300000m wait namespac tabl assign org apach hadoop hbase master tablenamespacemanag start tablenamespacemanag java 104 org apach hadoop hbase master hmaster initnamespac hmaster java 980 org apach hadoop hbase master hmaster finishactivemasteriniti hmaster java 779 org apach hadoop hbase master hmaster access 500 hmaster java 182 org apach hadoop hbase master hmaster 1 run hmaster java 1632 java lang thread run thread java 745 2015 05 28 10 06 27 293 fatal ip 111 22 33 444 16000 activemastermanag master hmaster master server abort load coprocessor org apach ranger author hbase rangerauthorizationcoprocessor 2015 05 28 10 06 27 293 fatal ip 111 22 33 444 16000 activemastermanag master hmaster unhandl start shutdown java io ioexcept timedout 300000m wait namespac tabl assign org apach hadoop hbase master tablenamespacemanag start tablenamespacemanag java 104 org apach hadoop hbase master hmaster initnamespac hmaster java 980 org apach hadoop hbase master hmaster finishactivemasteriniti hmaster java 779 org apach hadoop hbase master hmaster access 500 hmaster java 182 org apach hadoop hbase master hmaster 1 run hmaster java 1632 java lang thread run thread java 745