illegalstateexcept thrown scan bulkload hfile illegalstateexcept thrown scan hfile bulk load minut ago shown 2015 12 16 22 20 54 456 error taobao kart coprocessor server kartcoprocessor icbu ae ws product 0055 1450275490479 6a6a700f465ad074287fed720c950f7c batchnotifi java lang illegalstateexcept encodedscann work encod data block org apach hadoop hbase io hfile hfilereaderv2 encodedscannerv2 updatecurrentblock hfilereaderv2 java 1042 org apach hadoop hbase io hfile hfilereaderv2 encodedscannerv2 seekto hfilereaderv2 java 1093 org apach hadoop hbase regionserv storefilescann seekatoraft storefilescann java 244 org apach hadoop hbase regionserv storefilescann seek storefilescann java 152 org apach hadoop hbase regionserv storescann seekscann storescann java 329 org apach hadoop hbase regionserv storescann lt init gt storescann java 188 org apach hadoop hbase regionserv hstore getscann hstore java 1879 org apach hadoop hbase regionserv hregion regionscannerimpl lt init gt hregion java 4068 org apach hadoop hbase regionserv hregion instantiateregionscann hregion java 2029 org apach hadoop hbase regionserv hregion getscann hregion java 2015 org apach hadoop hbase regionserv hregion getscann hregion java 1992 amp apo hbase hfile amp apo command analys meta block info hfile find data block encod amp apo diff amp apo fileinfo data block written encod algorithm blocktyp amp apo data amp apo amp apo encod data amp apo fileinfo bloom filter type row bulkload sourc task attempt 1442077249005 606706 000012 0 bulkload timestamp x00 x00 x01r x12 x13 x12 data block encod diff datablock header hfileblock fileoffset 0 headers 33 blocktyp data ondisksizewithouthead 65591 uncompressedsizewithouthead 65571 prevblockoffset 1 isusehbasechecksum true checksumtyp crc32 bytesperchecksum 16384 ondiskdatasizewithhead 65604 getondisksizewithhead 65624 totalchecksumbyt 20 isunpack true buf java nio heapbytebuff po 0 lim 65624 cap 65657 arrai length 65657 arrayoffset 0 databeginswith x00 x00 x003 x00 x00 x00 x0a x00 x10 0008 1000000008 x01dprod filecontext hfilecontext useshbasechecksum true checksumtyp crc32 bytesperchecksum 16384 blocksiz 65536 encod includesmvcc true includestag fals compressalgo compresstag fals cryptocontext cipher keyhash data block encod file info consist data block wrong bulkload process debug step bulkload found loadincrementalhfil bug load hfile split region copi half hfile hfile privat static void copyhfilehalf configur conf path infil path outfil refer refer hcolumndescriptor familydescriptor throw ioexcept filesystem fs infil getfilesystem conf cacheconfig cacheconf cacheconfig conf halfstorefileread halfread null storefil writer halfwrit null halfread halfstorefileread fs infil cacheconf refer conf map lt byte byte gt fileinfo halfread loadfileinfo int blocksiz familydescriptor getblocks algorithm compress familydescriptor getcompress bloomtyp bloomfiltertyp familydescriptor getbloomfiltertyp cf amp apo data block encod initi hfile writer hfilecontext hfilecontext hfilecontextbuild withcompress compress withchecksumtyp hstore getchecksumtyp conf withbytesperchecksum hstore getbytesperchecksum conf withblocks blocksiz withdatablockencod familydescriptor getdatablockencod build halfwrit storefil writerbuild conf cacheconf fs withfilepath outfil withbloomtyp bloomfiltertyp withfilecontext hfilecontext build hfilescann scanner halfread getscann fals fals fals scanner seekto keyvalu kv keyvalueutil ensurekeyvalu scanner getkeyvalu halfwrit append kv scanner forc encod set origin hfile amp apo file info map entri lt byte byte gt entri fileinfo entryset shouldcopyhfilemetakei entri getkei halfwrit appendfileinfo entri getkei entri getvalu final halfwrit null halfwrit close halfread null halfread close cacheconf shouldevictonclos shown hfile diff encod bulkload split region cf amp apo data block encod hfile inconsist encod split region amp apo data block encod diff bulk load hfile initi bulkload hfile write encod info meta noopdatablockencod savemetadata empti rewrit encod gener file copyhfilehalf hfile amp apo meta info consist block header diff thrown scan file