region assign region server hbase drain hbase master failov problem region server regist drain continu drain znode hmaster failov balanc assign region reproduc hbase master add regionserv hbase drain bin hbase jrubi bin drain server rb add server1 16205 unload regionserv bin hbase jrubi bin region mover rb unload server1 16205 kill activ hmaster failov backup hmaster run balanc hbase shell lt lt lt balanc notic region assign activ master region server hbase drain root backup hmaster initi drainingservertrack region server regist onlin servermanag result servermanag drainingserv isn amp apo popul exist region server drain hmaster failov region server drain server1 16205 1000 regionservertrack start add zk watcher znode regionserv hbase rs server1 16205 1000 drainingservertrack start process znode hbase drain region server isn amp apo regist onlin isn amp apo ad servermanag drainingserv list region server ad drainingservertrack drainingserv list region server amp apo znode watcher trigger zk watcher restart region server regist servermanag onlin end state region server znode hbase drain regist onlin balanc start assign region bin hbase jrubi bin drain server rb list 1 server1 16205 1000 grep server1 16205 1000 log master server1 log 2016 10 14 16 02 47 713 debug server1 16001 activemastermanag zookeep zkutil master 16001 0x157c56adc810014 quorum localhost 2181 baseznod hbase set watcher exist znode hbase rs server1 16205 1000 2 2016 10 14 16 02 47 722 debug server1 16001 activemastermanag zookeep regionservertrack ad track rs hbase rs server1 16205 1000 2016 10 14 16 02 47 730 debug server1 16001 activemastermanag zookeep zkutil master 16001 0x157c56adc810014 quorum localhost 2181 baseznod hbase set watcher exist znode hbase drain server1 16205 1000 3 2016 10 14 16 02 47 731 warn server1 16001 activemastermanag master servermanag server server1 16205 1000 onlin request add drain list 4 2016 10 14 16 02 47 731 info server1 16001 activemastermanag zookeep drainingservertrack drain rs node creat ad list server1 16205 1000 2016 10 14 16 02 47 971 debug main eventthread zookeep zkutil master 16001 0x157c56adc810014 quorum localhost 2181 baseznod hbase set watcher exist znode hbase rs dev6918 prn2 facebook 16205 1476486047114 5 2016 10 14 16 02 47 976 debug main eventthread zookeep regionservertrack ad track rs hbase rs server1 16205 1000 6 2016 10 14 16 02 52 084 info rpcserver fifowfpbq default handler 29 queue 2 port 16001 master servermanag regist server server1 16205 1000