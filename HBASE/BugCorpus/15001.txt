thread safeti issu replicationsinkmanag hbaseinterclusterreplicationendpoint replicationsinkmanag thread safe problem hbaseinterclusterreplicationendpoint walprovid multiw 1 multipl thread report bad sink sink list empti report neg size arraylist thread safe 2 hbaseinterclusterreplicationendpoint depend number sink batch edit ship amp apo code make assum batch process sink size time reach batch part sink size replicationsinkmgr getsink size 0 return fals int math min math min maxthread entri size 100 1 replicationsinkmgr getsink size updat lead arithmeticexcept divis entrylist math ab byte hashcod getkei getencodedregionnam add benign lead retri replicationsourc idea make oper replicationsinkmanag thread safe verif size replic edit report success