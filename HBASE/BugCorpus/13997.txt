scannercallablewithreplica infinit block bug scannercallablewithreplica addcallsforotherreplica method code scannercallablewithreplica addcallsforotherreplica privat int addcallsforotherreplica boundedcompletionservic lt pair lt result scannercal gt gt cs regionloc rl int min int max scan getconsist consist strong return 0 schedul replica strong consist int id min id lt max id currentscannercal gethregioninfo getreplicaid id continu schedul earlier scannercal currentscannercal getscannercallableforreplica id lastresult null getscan setstartrow lastresult getrow outstandingcal add retryingrpc retryingonreplica retryingrpc cs submit retryingonreplica return max min 1 bug max min continu complet lt submit code infinit block code scannercallablewithreplica call submit larger submit addcallsforotherreplica cs rl 0 rl size 1 affect complet lt submit futur lt pair lt result scannercal gt gt cs pair lt result scannercal gt null amp amp getsecond null updatecurrentlyservingreplica getsecond getfirst pool return null null getfirst great answer catch executionexcept cancel interrupt wait rpc amp apo task fail save null arraylist lt executionexcept gt rl size add complet catch cancellationexcept throw interruptedioexcept getmessag catch interruptedexcept throw interruptedioexcept getmessag final interrupt call succeed fail case stop task cs cancelal true replica rs occur executionexcept infinit block cs